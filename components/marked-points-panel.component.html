<div class="fixed bottom-0 left-0 right-0 z-[1001] transition-transform duration-300 ease-in-out" 
    [class.-translate-y-16]="isOpen" [class.translate-y-full]="!isOpen">
    <div class="marked-points-panel-content">
        <div class="flex items-center justify-between p-2 border-b border-[var(--color-surface-light)]">
            <div class="flex items-center space-x-2 overflow-hidden">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-[var(--color-accent)] flex-shrink-0"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                <div>
                    <h3 class="font-bold text-sm leading-tight truncate">Route Planner</h3>
                    <p class="text-xs text-[var(--color-text-secondary)] leading-tight">{{ points.length }} points, Total: {{ measurementService.formatDistance(totalDistance) }}</p>
                </div>
            </div>
            <button (click)="closePanel.emit()" class="p-1.5 rounded-full hover:bg-red-900/50 text-[var(--color-danger)]" title="Close Planner">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
        </div>
        <div #list class="flex-grow overflow-y-auto p-2 max-h-[30vh]">
            <div *ngIf="points.length > 0; else noPoints" class="space-y-0.5">
                <div *ngFor="let point of points" class="flex items-center justify-between p-1.5 rounded-md hover:bg-[var(--color-surface-lighter)]/50 transition-colors">
                    <div class="flex items-center space-x-2">
                        <span class="font-bold text-[var(--color-accent)] w-8 text-center">{{ point.name }}</span>
                        <div class="text-xs font-mono">
                            <p>{{ getCoordsString(point) }}</p>
                            <p class="text-[var(--color-text-secondary)]">Total: {{ measurementService.formatDistance(point.totalDistance) }}</p>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <button (click)="goTo.emit(point)" class="p-1.5 rounded-full hover:bg-[var(--color-surface-light)] text-[var(--color-text-secondary)] hover:text-white" title="Navigate to point"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><circle cx="12" cy="12" r="8"></circle><line x1="12" y1="2" x2="12" y2="6"></line><line x1="12" y1="18" x2="12" y2="22"></line><line x1="2" y1="12" x2="6" y2="12"></line><line x1="18" y1="12" x2="22" y2="12"></line></svg></button>
                        <button (click)="delete.emit(point.id)" class="p-1.5 rounded-full hover:bg-red-900/50 text-[var(--color-danger)]" title="Delete point"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg></button>
                    </div>
                </div>
            </div>
            <ng-template #noPoints>
                <div class="text-center py-6 text-[var(--color-text-secondary)]"><p class="text-sm">Tap on the map to add points.</p></div>
            </ng-template>
        </div>
        <div class="flex-shrink-0 p-2 border-t border-[var(--color-surface-light)] bg-[var(--color-background)]/50 grid grid-cols-2 gap-1.5">
            <button (click)="addCurrentLocation.emit()" class="button-secondary"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line></svg><span>Add My Location</span></button>
            <button (click)="saveRoute.emit()" [disabled]="points.length === 0" class="button-primary"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg><span>Save Route</span></button>
        </div>
    </div>
</div>
